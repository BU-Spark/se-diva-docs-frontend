{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { useCallback } from 'react';\nimport { useDelete } from '../../dataProvider';\nimport { useUnselect } from '../../controller';\nimport { useRedirect } from '../../routing';\nimport { useNotify } from '../../notification';\nimport { useResourceContext } from '../../core';\n/**\n * Prepare callback for a Delete button with undo support\n *\n * @example\n *\n * import React from 'react';\n * import ActionDelete from '@mui/icons-material/Delete';\n * import { Button, useDeleteWithUndoController } from 'react-admin';\n *\n * const DeleteButton = ({\n *     resource,\n *     record,\n *     redirect,\n *     onClick,\n *     ...rest\n * }) => {\n *     const { isLoading, handleDelete } = useDeleteWithUndoController({\n *         resource,\n *         record,\n *         redirect,\n *         onClick,\n *     });\n *\n *     return (\n *         <Button\n *             onClick={handleDelete}\n *             disabled={isLoading}\n *             label=\"ra.action.delete\"\n *             {...rest}\n *         >\n *             <ActionDelete />\n *         </Button>\n *     );\n * };\n */\nvar useDeleteWithUndoController = function (props) {\n  var record = props.record,\n    _a = props.redirect,\n    redirectTo = _a === void 0 ? 'list' : _a,\n    onClick = props.onClick,\n    _b = props.mutationOptions,\n    mutationOptions = _b === void 0 ? {} : _b;\n  var mutationMeta = mutationOptions.meta,\n    otherMutationOptions = __rest(mutationOptions, [\"meta\"]);\n  var resource = useResourceContext(props);\n  var notify = useNotify();\n  var unselect = useUnselect(resource);\n  var redirect = useRedirect();\n  var _c = useDelete(),\n    deleteOne = _c[0],\n    isLoading = _c[1].isLoading;\n  var handleDelete = useCallback(function (event) {\n    event.stopPropagation();\n    deleteOne(resource, {\n      id: record.id,\n      previousData: record,\n      meta: mutationMeta\n    }, __assign({\n      onSuccess: function () {\n        notify('ra.notification.deleted', {\n          type: 'info',\n          messageArgs: {\n            smart_count: 1\n          },\n          undoable: true\n        });\n        unselect([record.id]);\n        redirect(redirectTo, resource);\n      },\n      onError: function (error) {\n        notify(typeof error === 'string' ? error : error.message || 'ra.notification.http_error', {\n          type: 'warning',\n          messageArgs: {\n            _: typeof error === 'string' ? error : error && error.message ? error.message : undefined\n          }\n        });\n      },\n      mutationMode: 'undoable'\n    }, otherMutationOptions));\n    if (typeof onClick === 'function') {\n      onClick(event);\n    }\n  }, [deleteOne, mutationMeta, otherMutationOptions, notify, onClick, record, redirect, redirectTo, resource, unselect]);\n  return {\n    isLoading: isLoading,\n    handleDelete: handleDelete\n  };\n};\nexport default useDeleteWithUndoController;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;AAAA,SAASA,WAAW,QAA2B,OAAO;AAGtD,SAASC,SAAS,QAAQ,oBAAoB;AAC9C,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,WAAW,QAA+B,eAAe;AAClE,SAASC,SAAS,QAAQ,oBAAoB;AAE9C,SAASC,kBAAkB,QAAQ,YAAY;AAE/C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA,IAAMC,2BAA2B,GAAG,UAChCC,KAAoD;EAGhD,UAAM,GAINA,KAAK,OAJC;IACNC,KAGAD,KAAK,SAHwB;IAAnBE,UAAU,mBAAG,MAAM;IAC7BC,OAAO,GAEPH,KAAK,QAFE;IACPI,KACAJ,KAAK,gBADe;IAApBK,eAAe,mBAAG,EAAE;EAEhB,IAAMC,YAAY,GAA8BD,eAAe,KAA7C;IAAKE,oBAAoB,UAAKF,eAAe,EAAjE,QAA+C,CAAF;EACnD,IAAMG,QAAQ,GAAGV,kBAAkB,CAACE,KAAK,CAAC;EAC1C,IAAMS,MAAM,GAAGZ,SAAS,EAAE;EAC1B,IAAMa,QAAQ,GAAGf,WAAW,CAACa,QAAQ,CAAC;EACtC,IAAMG,QAAQ,GAAGf,WAAW,EAAE;EACxB,SAA6BF,SAAS,EAAc;IAAnDkB,SAAS;IAAIC,SAAS,kBAA6B;EAE1D,IAAMC,YAAY,GAAGrB,WAAW,CAC5B,eAAK;IACDsB,KAAK,CAACC,eAAe,EAAE;IACvBJ,SAAS,CACLJ,QAAQ,EACR;MACIS,EAAE,EAAEC,MAAM,CAACD,EAAE;MACbE,YAAY,EAAED,MAAM;MACpBE,IAAI,EAAEd;KACT;MAEGe,SAAS,EAAE;QACPZ,MAAM,CAAC,yBAAyB,EAAE;UAC9Ba,IAAI,EAAE,MAAM;UACZC,WAAW,EAAE;YAAEC,WAAW,EAAE;UAAC,CAAE;UAC/BC,QAAQ,EAAE;SACb,CAAC;QACFf,QAAQ,CAAC,CAACQ,MAAM,CAACD,EAAE,CAAC,CAAC;QACrBN,QAAQ,CAACT,UAAU,EAAEM,QAAQ,CAAC;MAClC,CAAC;MACDkB,OAAO,EAAE,UAACC,KAAY;QAClBlB,MAAM,CACF,OAAOkB,KAAK,KAAK,QAAQ,GACnBA,KAAK,GACLA,KAAK,CAACC,OAAO,IAAI,4BAA4B,EACnD;UACIN,IAAI,EAAE,SAAS;UACfC,WAAW,EAAE;YACTM,CAAC,EACG,OAAOF,KAAK,KAAK,QAAQ,GACnBA,KAAK,GACLA,KAAK,IAAIA,KAAK,CAACC,OAAO,GACtBD,KAAK,CAACC,OAAO,GACbE;;SAEjB,CACJ;MACL,CAAC;MACDC,YAAY,EAAE;IAAU,GACrBxB,oBAAoB,EAE9B;IACD,IAAI,OAAOJ,OAAO,KAAK,UAAU,EAAE;MAC/BA,OAAO,CAACY,KAAK,CAAC;;EAEtB,CAAC,EACD,CACIH,SAAS,EACTN,YAAY,EACZC,oBAAoB,EACpBE,MAAM,EACNN,OAAO,EACPe,MAAM,EACNP,QAAQ,EACRT,UAAU,EACVM,QAAQ,EACRE,QAAQ,CACX,CACJ;EAED,OAAO;IAAEG,SAAS;IAAEC,YAAY;EAAA,CAAE;AACtC,CAAC;AAuBD,eAAef,2BAA2B","names":["useCallback","useDelete","useUnselect","useRedirect","useNotify","useResourceContext","useDeleteWithUndoController","props","_a","redirectTo","onClick","_b","mutationOptions","mutationMeta","otherMutationOptions","resource","notify","unselect","redirect","deleteOne","isLoading","handleDelete","event","stopPropagation","id","record","previousData","meta","onSuccess","type","messageArgs","smart_count","undoable","onError","error","message","_","undefined","mutationMode"],"sourceRoot":"","sources":["../../../../src/controller/button/useDeleteWithUndoController.tsx"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}