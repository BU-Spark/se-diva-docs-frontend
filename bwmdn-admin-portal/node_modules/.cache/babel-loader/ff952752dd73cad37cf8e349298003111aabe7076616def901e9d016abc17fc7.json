{"ast":null,"code":"import { useEffect } from 'react';\nimport { useFormContext } from 'react-hook-form';\nimport get from 'lodash/get';\nimport { useRecordContext } from '../controller';\n/*\n * This hook updates the input default value whenever the record changes\n * It applies either the record value if it has one or the defaultValue if it was specified\n */\nexport var useApplyInputDefaultValues = function (props) {\n  var defaultValue = props.defaultValue,\n    source = props.source;\n  var record = useRecordContext(props);\n  var _a = useFormContext(),\n    getValues = _a.getValues,\n    resetField = _a.resetField,\n    getFieldState = _a.getFieldState,\n    formState = _a.formState;\n  var recordValue = get(record, source);\n  var formValue = get(getValues(), source);\n  var isDirty = getFieldState(source, formState).isDirty;\n  useEffect(function () {\n    if (defaultValue == null) return;\n    if (formValue == null && recordValue == null && !isDirty) {\n      // special case for ArrayInput: since we use get(record, source),\n      // if source is like foo.23.bar, this effect will run.\n      // but we only want to set the default value for the subfield bar\n      // if the record actually has a value for foo.23\n      var pathContainsIndex = source.split('.').some(function (pathPart) {\n        return numericRegex.test(pathPart);\n      });\n      if (pathContainsIndex) {\n        var parentPath = source.split('.').slice(0, -1).join('.');\n        var parentValue = get(getValues(), parentPath);\n        if (parentValue == null) {\n          // the parent is undefined, so we don't want to set the default value\n          return;\n        }\n      }\n      resetField(source, {\n        defaultValue: defaultValue\n      });\n    }\n  });\n};\nvar numericRegex = /^\\d+$/;","map":{"version":3,"mappings":"AAAA,SAASA,SAAS,QAAQ,OAAO;AACjC,SAASC,cAAc,QAAQ,iBAAiB;AAChD,OAAOC,GAAG,MAAM,YAAY;AAC5B,SAASC,gBAAgB,QAAQ,eAAe;AAGhD;;;;AAIA,OAAO,IAAMC,0BAA0B,GAAG,UACtCC,KAA+C;EAEvC,gBAAY,GAAaA,KAAK,aAAlB;IAAEC,MAAM,GAAKD,KAAK,OAAV;EAC5B,IAAME,MAAM,GAAGJ,gBAAgB,CAACE,KAAK,CAAC;EAChC,SAKFJ,cAAc,EAAE;IAJhBO,SAAS;IACTC,UAAU;IACVC,aAAa;IACbC,SAAS,eACO;EACpB,IAAMC,WAAW,GAAGV,GAAG,CAACK,MAAM,EAAED,MAAM,CAAC;EACvC,IAAMO,SAAS,GAAGX,GAAG,CAACM,SAAS,EAAE,EAAEF,MAAM,CAAC;EAClC,WAAO,GAAKI,aAAa,CAACJ,MAAM,EAAEK,SAAS,CAAC,QAArC;EAEfX,SAAS,CAAC;IACN,IAAIc,YAAY,IAAI,IAAI,EAAE;IAC1B,IAAID,SAAS,IAAI,IAAI,IAAID,WAAW,IAAI,IAAI,IAAI,CAACG,OAAO,EAAE;MACtD;MACA;MACA;MACA;MACA,IAAMC,iBAAiB,GAAGV,MAAM,CAC3BW,KAAK,CAAC,GAAG,CAAC,CACVC,IAAI,CAAC,kBAAQ;QAAI,mBAAY,CAACC,IAAI,CAACC,QAAQ,CAAC;MAA3B,CAA2B,CAAC;MAClD,IAAIJ,iBAAiB,EAAE;QACnB,IAAMK,UAAU,GAAGf,MAAM,CAACW,KAAK,CAAC,GAAG,CAAC,CAACK,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC;QAC3D,IAAMC,WAAW,GAAGtB,GAAG,CAACM,SAAS,EAAE,EAAEa,UAAU,CAAC;QAChD,IAAIG,WAAW,IAAI,IAAI,EAAE;UACrB;UACA;;;MAGRf,UAAU,CAACH,MAAM,EAAE;QAAEQ,YAAY;MAAA,CAAE,CAAC;;EAE5C,CAAC,CAAC;AACN,CAAC;AAED,IAAMW,YAAY,GAAG,OAAO","names":["useEffect","useFormContext","get","useRecordContext","useApplyInputDefaultValues","props","source","record","getValues","resetField","getFieldState","formState","recordValue","formValue","defaultValue","isDirty","pathContainsIndex","split","some","test","pathPart","parentPath","slice","join","parentValue","numericRegex"],"sources":["/Users/paigedeveau/Desktop/se-diva-docs-frontend/bwmdn-admin-portal/node_modules/ra-core/src/form/useApplyInputDefaultValues.ts"],"sourcesContent":["import { useEffect } from 'react';\nimport { useFormContext } from 'react-hook-form';\nimport get from 'lodash/get';\nimport { useRecordContext } from '../controller';\nimport { InputProps } from './useInput';\n\n/*\n * This hook updates the input default value whenever the record changes\n * It applies either the record value if it has one or the defaultValue if it was specified\n */\nexport const useApplyInputDefaultValues = (\n    props: Partial<InputProps> & { source: string }\n) => {\n    const { defaultValue, source } = props;\n    const record = useRecordContext(props);\n    const {\n        getValues,\n        resetField,\n        getFieldState,\n        formState,\n    } = useFormContext();\n    const recordValue = get(record, source);\n    const formValue = get(getValues(), source);\n    const { isDirty } = getFieldState(source, formState);\n\n    useEffect(() => {\n        if (defaultValue == null) return;\n        if (formValue == null && recordValue == null && !isDirty) {\n            // special case for ArrayInput: since we use get(record, source),\n            // if source is like foo.23.bar, this effect will run.\n            // but we only want to set the default value for the subfield bar\n            // if the record actually has a value for foo.23\n            const pathContainsIndex = source\n                .split('.')\n                .some(pathPart => numericRegex.test(pathPart));\n            if (pathContainsIndex) {\n                const parentPath = source.split('.').slice(0, -1).join('.');\n                const parentValue = get(getValues(), parentPath);\n                if (parentValue == null) {\n                    // the parent is undefined, so we don't want to set the default value\n                    return;\n                }\n            }\n            resetField(source, { defaultValue });\n        }\n    });\n};\n\nconst numericRegex = /^\\d+$/;\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}